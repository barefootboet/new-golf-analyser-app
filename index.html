<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="TrackMan Golf Swing Analyzer - Get personalized golf swing analysis based on your launch monitor data">
    <meta name="theme-color" content="#1e3c72">
    <title>TrackMan Golf Swing Analyzer</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';
        import { getFirestore, collection, addDoc, getDocs, query, orderBy, where, deleteDoc, doc, setDoc, getDoc } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyAG4QryGfnqxencNJJtt1rmj1fV4tSqGJs",
            authDomain: "swing-analysis-3afa2.firebaseapp.com",
            projectId: "swing-analysis-3afa2",
            storageBucket: "swing-analysis-3afa2.firebasestorage.app",
            messagingSenderId: "1067695630377",
            appId: "1:1067695630377:web:f9df849876d1f147871438",
            measurementId: "G-H8KY25JRJH"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        window.firebaseAuth = auth;
        window.firebaseDb = db;
        window.firebaseAuthFunctions = {
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            signOut,
            onAuthStateChanged
        };
        window.firestoreFunctions = {
            collection,
            addDoc,
            getDocs,
            query,
            orderBy,
            where,
            deleteDoc,
            doc,
            setDoc,
            getDoc
        };
    </script>
</head>
<body>
    <!-- Authentication Modal -->
    <div class="auth-overlay" id="authOverlay">
        <div class="auth-modal">
            <div class="auth-header" style="position: relative;">
                <button class="auth-close" onclick="closeAuthModal()">√ó</button>
                <h2>üîê Account Access</h2>
                <p>Sign in to save your data to the cloud</p>
            </div>
            <div class="auth-content">
                <div class="auth-tabs">
                    <button class="auth-tab active" onclick="switchAuthTab('signin')">Sign In</button>
                    <button class="auth-tab" onclick="switchAuthTab('signup')">Sign Up</button>
                </div>
                <div class="auth-error" id="authError"></div>
                <form class="auth-form active" id="signinForm" onsubmit="handleSignIn(event)">
                    <div class="auth-input-group">
                        <label for="signinEmail">Email</label>
                        <input type="email" id="signinEmail" placeholder="your@email.com" required>
                    </div>
                    <div class="auth-input-group">
                        <label for="signinPassword">Password</label>
                        <input type="password" id="signinPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                    </div>
                    <button type="submit" class="auth-submit-btn" id="signinBtn">Sign In</button>
                </form>
                <form class="auth-form" id="signupForm" onsubmit="handleSignUp(event)">
                    <div class="auth-input-group">
                        <label for="signupEmail">Email</label>
                        <input type="email" id="signupEmail" placeholder="your@email.com" required>
                    </div>
                    <div class="auth-input-group">
                        <label for="signupPassword">Password</label>
                        <input type="password" id="signupPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" minlength="6" required>
                        <small style="color: #666; font-size: 12px; margin-top: 4px; display: block;">At least 6 characters</small>
                    </div>
                    <div class="auth-input-group">
                        <label for="signupPasswordConfirm">Confirm Password</label>
                        <input type="password" id="signupPasswordConfirm" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" minlength="6" required>
                    </div>
                    <button type="submit" class="auth-submit-btn" id="signupBtn">Create Account</button>
                </form>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- User Info Bar (shown when signed in) -->
        <div class="user-info-bar" id="userInfoBar">
            <div>
                <span>üë§ Signed in as: </span>
                <span class="user-email" id="userEmail"></span>
            </div>
            <button class="logout-btn" onclick="handleLogout()">Sign Out</button>
        </div>
        <div class="header">
            <h1>‚õ≥ TrackMan Swing Analyzer</h1>
            <p>Get focused improvement tips based on your launch monitor data</p>
        </div>

        <div class="content">
            <!-- Sign In Prompt (shown when not logged in) -->
            <div class="sign-in-prompt" id="signInPrompt">
                <p>üîí <strong>Sign in to save your data to the cloud</strong> and access it from any device!</p>
                <button type="button" onclick="openAuthModal()">Sign In / Create Account</button>
            </div>
            <div class="section-header">
                <h2>üë§ Your Profile</h2>
                <p>Help us personalize your swing analysis</p>
            </div>

            <div class="profile-grid">
                <div class="input-group">
                    <label for="name">Name (Optional)</label>
                    <input type="text" id="name" placeholder="Your name">
                </div>

                <div class="input-group">
                    <label for="age">Age (Optional)</label>
                    <input type="number" id="age" placeholder="e.g., 32" min="10" max="100">
                </div>

                <div class="input-group">
                    <label for="handicap">Handicap Index <span class="required-star">*</span></label>
                    <input type="number" id="handicap" placeholder="e.g., 12.5" step="0.1" required>
                    <div class="error-message">Please enter your handicap</div>
                </div>

                <div class="input-group">
                    <label for="rounds">Rounds/Year (Optional)</label>
                    <input type="number" id="rounds" placeholder="e.g., 25" min="0">
                </div>

                <div class="input-group">
                    <label for="playerType">Player Type</label>
                    <select id="playerType">
                        <option value="amateur">Amateur</option>
                        <option value="competitive">Competitive Amateur</option>
                        <option value="teaching">Teaching Pro</option>
                        <option value="professional">Tour Professional</option>
                    </select>
                </div>
            </div>

            <div class="section-header">
                <h2>üèåÔ∏è Club Selection</h2>
                <p>Choose the club you want to analyze</p>
            </div>

            <div class="club-selector">
                <label for="club">Select Club:</label>
                <select id="club" onchange="handleClubChange()">
                    <option value="driver">Driver</option>
                    <option value="3wood">3 Wood</option>
                    <option value="5wood">5 Wood</option>
                    <option value="3iron">3 Iron</option>
                    <option value="4iron">4 Iron</option>
                    <option value="5iron">5 Iron</option>
                    <option value="6iron">6 Iron</option>
                    <option value="7iron">7 Iron</option>
                    <option value="8iron">8 Iron</option>
                    <option value="9iron">9 Iron</option>
                    <option value="pw">Pitching Wedge</option>
                    <option value="gw">Gap Wedge</option>
                    <option value="sw">Sand Wedge</option>
                    <option value="lw">Lob Wedge</option>
                </select>
            </div>

            <!-- Wedge Loft Input (shows only for wedges) -->
            <div class="wedge-loft-input" id="wedgeLoftContainer" style="display: none;">
                <div class="input-group">
                    <label for="wedgeLoft">Wedge Loft (¬∞) <span class="required-star">*</span></label>
                    <input type="number" id="wedgeLoft" placeholder="e.g., 50" step="1" min="44" max="64">
                    <small>Enter the loft of your wedge (typically 44-64¬∞)</small>
                    <div class="error-message">Please enter wedge loft</div>
                </div>
            </div>

            <div class="section-header">
                <h2>üìä TrackMan Data</h2>
                <p>Enter your launch monitor numbers</p>
            </div>

            <div class="required-note">
                <p><span class="required-star">*</span> = Required fields. Optional fields can be left blank or marked as "NA".</p>
            </div>

            <div class="input-grid">
                <div class="input-group">
                    <label for="smash">Smash Factor <span class="required-star">*</span></label>
                    <input type="number" id="smash" placeholder="e.g., 1.48" step="0.01" required>
                    <small>Ball speed √∑ Club speed</small>
                    <div class="error-message">Required: typically 1.20-1.52</div>
                </div>

                <div class="input-group">
                    <label for="launchAngle">Launch Angle (¬∞) <span class="required-star">*</span></label>
                    <input type="number" id="launchAngle" placeholder="e.g., 12.5" step="0.1" required>
                    <small>Initial vertical angle</small>
                    <div class="error-message">Required: typically 8-28¬∞</div>
                </div>

                <div class="input-group">
                    <label for="spinRate">Spin Rate (rpm) <span class="required-star">*</span></label>
                    <input type="number" id="spinRate" placeholder="e.g., 2400" step="50" required>
                    <small>Backspin rate</small>
                    <div class="error-message">Required: typically 2000-10000 rpm</div>
                </div>

                <div class="input-group">
                    <label for="faceToPath">Face to Path (¬∞)</label>
                    <input type="text" id="faceToPath" placeholder="e.g., 2.0 or NA">
                    <small>Face angle relative to path</small>
                </div>

                <div class="input-group">
                    <label for="dynamicLoft">Dynamic Loft (¬∞)</label>
                    <input type="text" id="dynamicLoft" placeholder="e.g., 13.5 or NA">
                    <small>Loft at impact</small>
                </div>

                <div class="input-group">
                    <label for="aoa">Attack Angle (¬∞)</label>
                    <input type="text" id="aoa" placeholder="e.g., -2.5 or NA">
                    <small>Negative = down, Positive = up</small>
                </div>

                <div class="input-group">
                    <label for="clubSpeed">Club Speed (mph)</label>
                    <input type="text" id="clubSpeed" placeholder="e.g., 95 or NA">
                    <small>Speed at impact</small>
                </div>

                <div class="input-group">
                    <label for="ballSpeed">Ball Speed (mph)</label>
                    <input type="text" id="ballSpeed" placeholder="e.g., 142 or NA">
                    <small>Speed off clubface</small>
                </div>

                <div class="input-group">
                    <label for="path">Club Path (¬∞)</label>
                    <input type="text" id="path" placeholder="e.g., 2.0 or NA">
                    <small>Negative = left, Positive = right</small>
                </div>

                <div class="input-group">
                    <label for="face">Face Angle (¬∞)</label>
                    <input type="text" id="face" placeholder="e.g., 1.5 or NA">
                    <small>Negative = closed, Positive = open</small>
                </div>
            </div>

            <button class="analyze-btn" id="analyzeBtn" onclick="analyzeSwing()">Analyze My Swing</button>

            <div class="results" id="results"></div>

            <!-- Session Notes -->
            <div class="session-notes" id="sessionNotes" style="display: none;">
                <h3>üìù Session Notes</h3>
                <p style="font-size: 14px; color: #666; margin-bottom: 10px;">Track what you're working on and any insights from this session.</p>
                <textarea id="notesInput" placeholder="e.g., Focused on keeping head behind ball at impact. Felt better extension through the ball..." rows="4"></textarea>
                <button class="save-notes-btn" onclick="saveSession()">Save Session & Notes</button>
            </div>

            <!-- View History Button -->
            <div style="margin-top: 20px; text-align: center;">
                <button class="history-btn" onclick="toggleHistory()">üìä View Session History</button>
            </div>

            <!-- History Section -->
            <div class="history-section" id="historySection" style="display: none;">
                <div class="history-header">
                    <h2>üìà Session History</h2>
                    <div class="history-controls">
                        <select id="historyClubFilter" onchange="filterHistory()">
                            <option value="all">All Clubs</option>
                            <option value="driver">Driver</option>
                            <option value="3wood">3 Wood</option>
                            <option value="5wood">5 Wood</option>
                            <option value="3iron">3 Iron</option>
                            <option value="4iron">4 Iron</option>
                            <option value="5iron">5 Iron</option>
                            <option value="6iron">6 Iron</option>
                            <option value="7iron">7 Iron</option>
                            <option value="8iron">8 Iron</option>
                            <option value="9iron">9 Iron</option>
                            <option value="pw">Pitching Wedge</option>
                            <option value="gw">Gap Wedge</option>
                            <option value="sw">Sand Wedge</option>
                            <option value="lw">Lob Wedge</option>
                        </select>
                        <button class="clear-history-btn" onclick="clearHistory()">Clear All History</button>
                    </div>
                </div>
                <div id="historyContent">
                    <p style="text-align: center; color: #666; padding: 40px 20px;">No sessions saved yet. Complete your first analysis to start tracking progress!</p>
                </div>
            </div>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="auth.js"></script>
    <script src="history.js"></script>
    <script src="analysis.js"></script>
    <script src="app.js"></script>
</body>
</html>
